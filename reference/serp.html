<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Smooth Effects on Response Penalty for CLM — serp • serp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Smooth Effects on Response Penalty for CLM — serp"><meta property="og:description" content="Fits cumulative link models (CLMs) with the
smooth-effect-on-response penalty (SERP) via a modified Newton-Raphson
algorithm. SERP enables the regularization of the parameter space between
the general and the restricted cumulative models, with a resultant shrinkage
of all subject-specific effects to global effects. The Akaike information
critrion (aic), K-fold cross validation (cv), among other tuning
aproaches, provide the means of arriving at an optimal tuning parameter in a
in a situation where a user-supplied tuning value is not available.
The slope argument allows for the selection of a penalized, unparallel,
parallel, or partial slope."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">serp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ejikeugba/serp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Smooth Effects on Response Penalty for CLM</h1>
    <small class="dont-index">Source: <a href="https://github.com/ejikeugba/serp/blob/HEAD/R/serp.R" class="external-link"><code>R/serp.R</code></a></small>
    <div class="hidden name"><code>serp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits cumulative link models (CLMs) with the
smooth-effect-on-response penalty (SERP) via a modified Newton-Raphson
algorithm. SERP enables the regularization of the parameter space between
the general and the restricted cumulative models, with a resultant shrinkage
of all subject-specific effects to global effects. The Akaike information
critrion (<code>aic</code>), K-fold cross validation (<code>cv</code>), among other tuning
aproaches, provide the means of arriving at an optimal tuning parameter in a
in a situation where a user-supplied tuning value is not available.
The <code>slope</code> argument allows for the selection of a penalized, unparallel,
parallel, or partial slope.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">serp</span><span class="op">(</span>
     <span class="va">formula</span>,
     link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span>,<span class="st">"loglog"</span>, <span class="st">"cloglog"</span>, <span class="st">"cauchit"</span><span class="op">)</span>,
     slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"penalize"</span>, <span class="st">"parallel"</span>, <span class="st">"unparallel"</span>, <span class="st">"partial"</span><span class="op">)</span>,
     tuneMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"cv"</span>, <span class="st">"finite"</span>, <span class="st">"user"</span><span class="op">)</span>,
     reverse <span class="op">=</span> <span class="cn">FALSE</span>,
     lambdaGrid <span class="op">=</span> <span class="cn">NULL</span>,
     cvMetric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brier"</span>, <span class="st">"logloss"</span>, <span class="st">"misclass"</span><span class="op">)</span>,
     gridType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"discrete"</span>, <span class="st">"fine"</span><span class="op">)</span>,
     globalEff <span class="op">=</span> <span class="cn">NULL</span>,
     <span class="va">data</span>,
     <span class="va">subset</span>,
     weights <span class="op">=</span> <span class="cn">NULL</span>,
     weight.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"analytic"</span>, <span class="st">"frequency"</span><span class="op">)</span>,
     na.action <span class="op">=</span> <span class="cn">NULL</span>,
     lambda <span class="op">=</span> <span class="cn">NULL</span>,
     contrasts <span class="op">=</span> <span class="cn">NULL</span>,
     control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
     <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>regression formula of the form: response ~ predictors. The
response should be a factor (ordered).</p></dd>
<dt>link</dt>
<dd><p>sets the link function for the cumulative link model including:
logit, probit, complementary log-log, cloglog, cauchit.</p></dd>
<dt>slope</dt>
<dd><p>selects the form of coefficients used in the model, with
<code>penalize</code> denoting the penalized coefficients, <code>unparallel</code>,
<code>parallel</code> and <code>partial</code> denoting the unpenalized non-parallel,
parallel and semi-parallel coefficients respectively.</p></dd>
<dt>tuneMethod</dt>
<dd><p>sets the method of choosing an optimal shrinkage
parameter, including: <code>aic</code>, <code>cv</code>, <code>finite</code> and
<code>user</code>. i.e., the lambda value along parameter shrinkage path at
which the fit's AIC or the k-fold cross-validated test error is
minimal. The finite tuning is used to obtain the model along parameter
shrinkage for which the log-Likelihood exist (is finite). The 'user'
tuning supports a user-supplied lambda value.</p></dd>
<dt>reverse</dt>
<dd><p>false by default, when true the sign of the linear predictor
is reversed.</p></dd>
<dt>lambdaGrid</dt>
<dd><p>optional user-supplied lambda grid for the <code>aic</code>,
and <code>cv</code> tuning methods, when the discrete <code>gridType</code>
is chosen. Negative range of values are not allowed. A short lambda grid
could increase computation time assuming large number of predictors and
cases in the model.</p></dd>
<dt>cvMetric</dt>
<dd><p>sets the performance metric for the cv tuning, with the
brier score used by default.</p></dd>
<dt>gridType</dt>
<dd><p>chooses if a discrete or a continuous lambda grid should be
used to select the optimal tuning parameter. The former is used by default
and could be adjusted as desired in <code>serp.control</code>. The latter
is on the range (0, <code>maxPen</code>). A user-supplied grid is also possible,
which automatically overrides the internal grid.</p></dd>
<dt>globalEff</dt>
<dd><p>specifies variable(s) to be assigned global effects during
penalization or when <code>slope</code> is set to <code>partial</code>. Variables are
specified as a formula with an empty left hand side, for instance,
globalEff = ~predictors.</p></dd>
<dt>data</dt>
<dd><p>optional dataframe explaining the variables used in the formula.</p></dd>
<dt>subset</dt>
<dd><p>specifies which subset of the rows of the data should be used
for fit. All observations are used by default.</p></dd>
<dt>weights</dt>
<dd><p>optional case weights in fitting. Negative weights are not
allowed. Defaults to 1.</p></dd>
<dt>weight.type</dt>
<dd><p>chooses between analytic and frequency weights with the
former used by default. The latter should be used when weights are mere
case counts used to compress the data set.</p></dd>
<dt>na.action</dt>
<dd><p>a function to filter missing data.</p></dd>
<dt>lambda</dt>
<dd><p>a user-supplied single numeric value for the tuning parameter
when using the <code>user</code> tuning method. Negative values are not
allowed.</p></dd>
<dt>contrasts</dt>
<dd><p>a list of contrasts to be used for some or all of the
factors appearing as variables in the model formula.</p></dd>
<dt>control</dt>
<dd><p>A list of fit control parameters to replace default values
returned by <code>serp.control</code>. Values not set assume default values.</p></dd>
<dt>...</dt>
<dd><p>additional arguments.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>aic</dt>
<dd><p>the akaike information criterion, with effective degrees of
        freedom obtained from the trace of the generalized hat matrix
        depending on the tuning parameter.</p></dd>
<dt>bic</dt>
<dd><p>the bayesian information criterion, with effective degrees of
        freedom obtained from the trace of the generalized hat matrix
        depending on the tuning parameter.</p></dd>
<dt>call</dt>
<dd><p>the matched call.</p></dd>
<dt>coef</dt>
<dd><p>a vector of coefficients of the fitted model.</p></dd>
<dt>converged</dt>
<dd><p>a character vector of fit convergence status.</p></dd>
<dt>contrasts</dt>
<dd><p>(where relevant) the contrasts used in the model.</p></dd>
<dt>control</dt>
<dd><p>list of control parameters from <code>serp.control</code>.</p></dd>
<dt>cvMetric</dt>
<dd><p>the performance metric used for cv tuning.</p></dd>
<dt>deviance</dt>
<dd><p>the residual deviance.</p></dd>
<dt>edf</dt>
<dd><p>the (effective) number of degrees of freedom used by the model</p></dd>
<dt>fitted.values</dt>
<dd><p>the fitted probabilities.</p></dd>
<dt>globalEff</dt>
<dd><p>variable(s) in model treated as global effect(s)</p></dd>
<dt>gradient</dt>
<dd><p>a column vector of gradients for the coefficients at the
        model convergence.</p></dd>
<dt>Hessian</dt>
<dd><p>the hessian matrix for the coefficients at the model
        convergence.</p></dd>
<dt>iter</dt>
<dd><p>number of interactions before convergence or non-convergence.</p></dd>
<dt>lambda</dt>
<dd><p>a user-supplied single numeric value for the <code>user</code>
        tuning tuning method.</p></dd>
<dt>lambdaGrid</dt>
<dd><p>a numeric vector of lambda values used to determine the
        optimum tuning parameter.</p></dd>
<dt>logLik</dt>
<dd><p>the realized log-likelihood at the model convergence.</p></dd>
<dt>link</dt>
<dd><p>character vector indicating the link function of the fit.</p></dd>
<dt>message</dt>
<dd><p>character vector stating the type of convergence obtained</p></dd>
<dt>misc</dt>
<dd><p>a list to hold miscellaneous fit information.</p></dd>
<dt>model</dt>
<dd><p>model.frame having variables from formula.</p></dd>
<dt>na.action</dt>
<dd><p>(where relevant) information on the treatment of NAs.</p></dd>
<dt>nobs</dt>
<dd><p>the number of observations.</p></dd>
<dt>nrFold</dt>
<dd><p>the number of k-fold cross validation for the cv tuning
        method. Default to k = 5.</p></dd>
<dt>rdf</dt>
<dd><p>the residual degrees of freedom</p></dd>
<dt>reverse</dt>
<dd><p>a logical vector indicating the the direction of the
        cumulative probabilities. Default to P(Y&lt;=r).</p></dd>
<dt>slope</dt>
<dd><p>a character vector indicating the type of slope parameters
        fitted. Default to <code>penalize</code>.</p></dd>
<dt>Terms</dt>
<dd><p>the terms structure describing the model.</p></dd>
<dt>testError</dt>
<dd><p>numeric value of the cross-validated test error at which
        the optimal tuning parameter emerged.</p></dd>
<dt>tuneMethod</dt>
<dd><p>a character vector specifying the method for choosing an
        optimal shrinkage parameter.</p></dd>
<dt>value</dt>
<dd><p>numeric value of AIC or logLik obtained at the optimal tuning
        parameter when using <code>aic</code> or <code>finite</code> tuning methods respectively.</p></dd>
<dt>ylev</dt>
<dd><p>the number of the response levels.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>serp</code> function fits the cumulative link model (CLM)
with smooth-effect-on-response penalty (SERP). The cumulative
model developed by McCullagh (1980) is probably most frequently
used ordinal model. When motivated by an underlying latent
variable, a simple form of the model is expressed as follows:</p>
<p>$$P(Y\leq r|x) = F(\delta_{0r} + x^T\delta)$$</p>
<p>where \(x\) is a vector of covariates, \(\delta\) a vector
of regression parameters and \(F\) a continuous distribution
function. This model assumes that the effect of \(x\) does not
depend on the  category. However, with this assumption relaxed,
one obtains the following general cumulative model:</p>
<p>$$P(Y\leq r|x) = F(\delta_{0r} + x^T\delta_{r}),$$</p>
<p>where r=1,...,k-1. This model, however, has the stochastic ordering
property, which implies that \(P(Y\leq r-1|x) &lt; P(Y\leq r|x)\)
holds for all \(x\) and all categories \(r\). Such assumption
is often problematic, resulting in unstable likelihoods with
ill-conditioned parameter space during the iterative procedure.</p>
<p>SERP offers a means of arriving at stable estimates of the general model.
It provides a form of regularization that is based on minimizing the
penalized log-likelihood:</p>
<p>$$l_{p}(\delta)=l(\delta)-J_{\lambda}(\delta)$$</p>
<p>where \(l(\delta)\), is the log-likelihood of the general cumulative
model and \(J_{\lambda}(\delta)=\lambda J(\delta)\) the penalty
function weighted by the turning parameter \(\lambda\). Assuming an
ordered categorical outcome \(Y \in \{1,\dots,k\}\), and considering
that the corresponding parameters \(\delta_{1j},\dots \delta_{k-1,j}\)
vary smoothly over the categories, the following penalty
(Tutz and Gertheiss, 2016),</p>
<p>$$J_{\lambda}(\delta)= \sum_{j=1}^{p} \sum_{r=1}^{k-2}
(\delta_{r+1,j}-\delta_{rj})^{2}$$</p>
<p>enables the smoothing of response categories such that all
category-specific effects associated with the response turn towards a
common global effect. SERP could also be applied to a semi-parallel model
with only the category-specific part of the model penalized. See,
Ugba (2021), Ugba et al. (2021) for further details and application in
empirical studies.</p>
<p>An object of class <code>serp</code> with the components listed below,
depending on the type of slope modeled. Other summary methods include:
 <code>summary</code>, <code>coef</code>, <code>predict</code>, <code>vcov</code>,
<code>anova</code>, etc.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ugba, E. R. (2021). serp: An R package for smoothing in ordinal regression
    <em>Journal of Open Source Software</em>, 6(66), 3705.
    https://doi.org/10.21105/joss.03705</p>
<p>Ugba, E. R., Mörlein, D. and Gertheiss, J. (2021). Smoothing in Ordinal
    Regression: An Application to Sensory Data. <em>Stats</em>, 4, 616–633.
    https://doi.org/10.3390/stats4030037</p>
<p>Tutz, G. and Gertheiss, J. (2016). Regularized Regression
    for Categorical Data (With Discussion and Rejoinder).
    <em>Statistical Modelling</em>, 16, pp. 161-260.
    https://doi.org/10.1177/1471082X16642560</p>
<p>McCullagh, P. (1980). Regression Models for Ordinal Data.
    <em>Journal of the Royal Statistical Society. Series B
    (Methodological)</em>, 42, pp. 109-142.
    https://doi.org/10.1111/j.2517-6161.1980.tb01109.x</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="anova.serp.html">anova.serp</a></code>, <code><a href="summary.serp.html">summary.serp</a></code>,
<code><a href="predict.serp.html">predict.serp</a></code>, <code><a href="confint.serp.html">confint.serp</a></code>,
<code><a href="vcov.serp.html">vcov.serp</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ejikeugba/serp" class="external-link">serp</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The unpenalized non-proportional odds model returns unbounded estimates, hence,</span></span>
<span class="r-in"><span class="co">## not fully identifiable.</span></span>
<span class="r-in"><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">serp</span><span class="op">(</span><span class="va">rating</span> <span class="op">~</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">contact</span>, slope <span class="op">=</span> <span class="st">"unparallel"</span>,</span>
<span class="r-in">           reverse <span class="op">=</span> <span class="cn">TRUE</span>, link <span class="op">=</span> <span class="st">"logit"</span>, data <span class="op">=</span> <span class="va">wine</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):1 (Intercept):2 (Intercept):3 (Intercept):4    tempwarm:1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.225774     -1.032996     -3.946377    -19.184272     19.242728 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    tempwarm:2    tempwarm:3    tempwarm:4  contactyes:1  contactyes:2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2.110849      2.940411     17.063644      1.659372      1.342884 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contactyes:3  contactyes:4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.692808      1.162201 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The penalized non-proportional odds model with a user-supplied lambda gives</span></span>
<span class="r-in"><span class="co">## a fully identified model with bounded estimates. A suitable tuning criterion</span></span>
<span class="r-in"><span class="co">## could as well be used to select lambda (e.g., aic, cv)</span></span>
<span class="r-in"><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">serp</span><span class="op">(</span><span class="va">rating</span> <span class="op">~</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">contact</span>, slope <span class="op">=</span> <span class="st">"penalize"</span>,</span>
<span class="r-in">           link <span class="op">=</span> <span class="st">"logit"</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span>, tuneMethod <span class="op">=</span> <span class="st">"user"</span>,</span>
<span class="r-in">           lambda <span class="op">=</span> <span class="fl">1e1</span>, data <span class="op">=</span> <span class="va">wine</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):1 (Intercept):2 (Intercept):3 (Intercept):4    tempwarm:1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.342671     -1.236068     -3.513122     -5.050240      2.518993 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    tempwarm:2    tempwarm:3    tempwarm:4  contactyes:1  contactyes:2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2.461986      2.554007      2.609441      1.526984      1.518964 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contactyes:3  contactyes:4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.536791      1.465075 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A penalized partial proportional odds model with some variables set to</span></span>
<span class="r-in"><span class="co">## global effect is also possible.</span></span>
<span class="r-in"><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu">serp</span><span class="op">(</span><span class="va">rating</span> <span class="op">~</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">contact</span>, slope <span class="op">=</span> <span class="st">"penalize"</span>,</span>
<span class="r-in">           reverse <span class="op">=</span> <span class="cn">TRUE</span>, link <span class="op">=</span> <span class="st">"logit"</span>, tuneMethod <span class="op">=</span> <span class="st">"user"</span>,</span>
<span class="r-in">           lambda <span class="op">=</span> <span class="fl">2e1</span>, globalEff <span class="op">=</span> <span class="op">~</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">wine</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):1 (Intercept):2 (Intercept):3 (Intercept):4      tempwarm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.342746     -1.236486     -3.423464     -4.993496      2.070177 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contactyes:1  contactyes:2  contactyes:3  contactyes:4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.832944      1.857316      1.921398      1.971866 </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## The unpenalized proportional odds model having constrained estimates can</span></span>
<span class="r-in"><span class="co">## as well be fit. Under extreme shrinkage, estimates in f2 equal those in</span></span>
<span class="r-in"><span class="co">## this model.</span></span>
<span class="r-in"><span class="va">f4</span> <span class="op">&lt;-</span>  <span class="fu">serp</span><span class="op">(</span><span class="va">rating</span> <span class="op">~</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">contact</span>, slope <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span class="r-in">            reverse <span class="op">=</span> <span class="cn">FALSE</span>, link <span class="op">=</span> <span class="st">"logit"</span>, data <span class="op">=</span> <span class="va">wine</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">f4</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">call:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> serp(formula = rating ~ temp + contact, link = "logit", slope = "parallel", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reverse = FALSE, data = wine)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Coefficients:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate Std Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):1  -1.3444    0.5085  -2.644  0.00820 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):2   1.2508    0.4391   2.849  0.00439 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):3   3.4669    0.5971   5.806 6.40e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept):4   5.0064    0.7291   6.867 6.56e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tempwarm       -2.5031    0.5320  -4.705 2.54e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contactyes     -1.5278    0.4736  -3.226  0.00126 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglik: -86.49192 on 282 degrees of freedom </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 184.9838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Exponentiated coefficients:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   tempwarm contactyes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08183069 0.21701410 </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ejike R. Ugba.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

